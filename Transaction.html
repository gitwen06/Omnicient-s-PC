<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Transaction</title>
    <link rel="stylesheet" href="stylesheet.css">
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="shop-style.css">
    <link rel="stylesheet" href="transaction-style.css">
    <link rel="stylesheet" href="media.css">
    <script type="module" src="login.js"></script>
    <script type="module" src="index.js"></script>
    <style>
        .transaction-container {
            display: flex;
            justify-content: center;
            align-items: flex-start;
            gap: 40px;
            max-width: 1000px;
            margin: 50px auto;
            padding: 30px;
            background: #222;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
        }

        .product-info,
        .transaction-form {
            margin-top: 10px;
            background: #333;
            padding: 30px;
            border-radius: 10px;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.3);
            width: 48%;
        }

        .product-image img {
            width: 220px;
            height: auto;
            display: block;
            margin: 0 auto 15px;
        }

        .product-name,
        .product-price {
            display: block;
            text-align: center;
            font-size: 20px;
            margin-bottom: 15px;
        }

        .transaction-form label {
            display: block;
            margin-top: 10px;
            font-weight: bold;
        }

        .transaction-form input,
        .transaction-form textarea,
        .transaction-form select {
            margin-top: 10px;
            width: 100%;
            padding: 8px;
            margin-top: 5px;
            border-radius: 5px;
            border: 1px solid #ddd;
            background: #fff;
            color: #000;
        }

        .transaction-form button {
            margin-top: 20px;
            width: 100%;
            padding: 10px;
            background: #76b900;
            border: none;
            border-radius: 5px;
            color: #000;
            font-weight: bold;
            cursor: pointer;
        }

        .transaction-form button:hover {
            background: #8cd400;
        }

        #main-footer {
            position: fixed;
            bottom: 0;
            width: 100%;
            text-align: center;
            background: #222;
            padding: 20px;
        }
    </style>
</head>

<body>
    <div class="content-wrapper">
        <section class="container landscape">
            <header>
                <nav id="nav_2">
                    <img src="images/Omniscient_s_PC_LOGO-removebg-preview.png" alt="Omniscient's PC Logo">
                    <ul id="list-1">
                        <li><a href="index.html" class="homepage">Home</a></li>
                        <li><a href="shop.html" class="shop">Shop</a></li>
                        <li id="loginNav"><a href="Login.html" class="Log in">Log In</a></li>
                        <li id="userNav" style="display: none;"><span id="usernameDisplay"></span></li>
                        <li id="logoutNav" style="display: none;"><a href="#" id="logoutLink">Log Out</a></li>
                    </ul>
                </nav>
            </header>

            <section class="transaction-container">
                <section class="product-info">
                    <span class="product-image">
                        <img src="images/product.jpg" alt="Product Name">
                    </span>
                    <span class="product-name">Product Name</span>
                    <span class="product-price">Product Price</span>
                </section>

                <form id="checkout-form" class="transaction-form">
                    <label for="name">Full Name:</label>
                    <input type="text" id="name" name="name" required>

                    <label for="email">Email:</label>
                    <input type="email" id="email" name="email" required>

                    <label for="address">Shipping Address:</label>
                    <textarea id="address" name="address" required></textarea>

                    <label for="payment">Payment Method:</label>
                    <select id="payment" name="payment" required>
                        <option value="cash_on_delivery">Cash on Delivery</option>
                    </select>

                    <!-- Additional fields for Cash on Delivery -->
                    <div id="payment-details" style="margin-top: 20px;">
                        <div id="cod-fields">
                            <p>Cash on Delivery selected. Please ensure the shipping address is correct.</p>
                        </div>
                    </div>

                    <button type="submit" class="confirm-btn">Confirm Purchase</button>
                    <button type="button" class="cancel-btn">Cancel</button>
                </form>

                <section id="cpu-specifications" class="specifications-container">
                    <p>Architecture: <span class="architecture">Example Value</span></p>
                    <p>Cores: <span class="cores">Example Value</span></p>
                    <p>Threads: <span class="threads">Example Value</span></p>
                    <p>Max Turbo Frequency: <span class="maxturbofrequency">Example Value</span></p>
                    <p>Socket Type: <span class="sockettype">Example Value</span></p>
                    <p>Overclockable: <span class="overclockable">Example Value</span></p>
                </section>

                <section id="gpu-specifications" class="specifications-container">
                    <p>Memory: <span class="memory"></span></p>
                    <p>DLSS: <span class="dlss"></span></p>
                    <p>OpenGL Version: <span class="openglversion"></span></p>
                    <p>DirectX Version: <span class="directx"></span></p>
                    <p>Core Clock: <span class="coreclock"></span></p>
                    <p>Cooling System: <span class="coolingsystem"></span></p>
                </section>

                <section id="ram-specifications" class="specifications-container">
                    <p>Memory Type: <span class="memorytype"></span></p>
                    <p>Capacity: <span class="amount"></span></p>
                    <p>Memory Speed: <span class="memoryspeed"></span></p>
                    <p>Tested Speed: <span class="testedspeed"></span></p>
                    <p>XMP Support: <span class="xmp"></span></p>
                    <p>Total Storage: <span class="storage"></span></p>
                </section>

                <section id="prebuilt-pc-specifications" class="specifications-container">
                    <p>CPU: <span class="cpu"></span></p>
                    <p>Motherboard: <span class="mobo"></span></p>
                    <p>Graphics Unit: <span class="graphicsunit"></span></p>
                    <p>Installed RAM: <span class="installedram"></span></p>
                    <p>SSD: <span class="ssd"></span></p>
                    <p>Power Unit: <span class="powerunit"></span></p>
                </section>
            </section>
        </section>
    </div>

    <footer id="main-footer">
        <section class="logo">
            <img src="images/Omniscient_s_PC_LOGO-removebg-preview.png" alt="Omniscient's PC Logo">
        </section>
        <p class="footer-link">
            <span><a href="#">Privacy Policy</a></span> |
            <span><a href="#">Legal Info</a></span> |
            <span><a href="#">Contact Us</a></span>
        </p>
        <section class="copyright">Copyright &copy; 2024 Omniscient's PC</section>
    </footer>

    <script>
        document.addEventListener("DOMContentLoaded", function () {
            const params = new URLSearchParams(window.location.search);

            // CPU-related variables
            const productName = params.get("name");
            const productImage = params.get("image");
            const productPrice = params.get("price");
            const architecture = params.get("architecture");
            const cores = params.get("cores");
            const threads = params.get("threads");
            const maxturbofrequency = params.get("maxturbofrequency");
            const sockettype = params.get("sockettype");
            const overclockable = params.get("overclockable");

            // GPU-related variables
            const memory = params.get("memory");
            const dlss = params.get("dlss");
            const openglversion = params.get("openglversion");
            const directx = params.get("directx");
            const coreclock = params.get("coreclock");
            const coolingsystem = params.get("coolingsystem");

            //RAM-related variables

            const memorytype = params.get("memorytype");
            const amount = params.get("amount");
            const memoryspeed = params.get("memoryspeed");
            const xmp = params.get("xmp");
            const storage = params.get("storage");
            const testedspeed = params.get("testedspeed");

            //Pre-Built PCs variables
            const cpu = params.get("cpu");
            const mobo = params.get("mobo");
            const graphicsunit = params.get("graphicsunit");
            const installedram = params.get("installedram");
            const ssd = params.get("ssd");
            const powerunit = params.get("powerunit");


            const urlParams = new URLSearchParams(window.location.search);

            // Check for GPU-specific keys
            const isGpuTransaction = urlParams.has("dlss") || urlParams.has("memory") || urlParams.has("coreclock");
            const isCpuTransaction = urlParams.has("cores");
            const isRamTransaction = urlParams.has("memoryspeed");
            const isPreBuiltPcTransaction = urlParams.has("graphicsunit");

            // Hide the CPU or GPU section based on the product type
            const cpuSection = document.getElementById("cpu-specifications");
            const gpuSection = document.getElementById("gpu-specifications");
            const ramsection = document.getElementById("ram-specifications");
            const prebuiltpcsection = document.getElementById("prebuilt-pc-specifications");

            if (isGpuTransaction) {
                if (cpuSection) cpuSection.style.display = "none";
                if (ramsection) ramsection.style.display = "none";
                if (prebuiltpcsection) prebuiltpcsection.style.display = "none";
            }

            if (isCpuTransaction) {
                if (gpuSection) gpuSection.style.display = "none";
                if (ramsection) ramsection.style.display = "none";
                if (prebuiltpcsection) prebuiltpcsection.style.display = "none";
            }

            if (isRamTransaction) {
                if (cpuSection) cpuSection.style.display = "none";
                if (gpuSection) gpuSection.style.display = "none";
                if (prebuiltpcsection) prebuiltpcsection.style.display = "none";
            }

            if (isPreBuiltPcTransaction) {
                if (cpuSection) cpuSection.style.display = "none";
                if (gpuSection) gpuSection.style.display = "none";
                if (ramsection) ramsection.style.display = "none";
            }


            // Set product details on the page
            if (productName && productImage) {
                document.querySelector(".product-name").textContent = productName;
                document.querySelector(".product-image img").src = productImage;
                document.querySelector(".product-price").textContent = productPrice;

                // Display CPU specifications if applicable
                if (isCpuTransaction) {
                    document.querySelector(".architecture").textContent = architecture;
                    document.querySelector(".cores").textContent = cores;
                    document.querySelector(".threads").textContent = threads;
                    document.querySelector(".maxturbofrequency").textContent = maxturbofrequency;
                    document.querySelector(".sockettype").textContent = sockettype;
                    document.querySelector(".overclockable").textContent = overclockable;
                }

                // Display GPU specifications if applicable
                if (isGpuTransaction) {
                    document.querySelector(".memory").textContent = memory;
                    document.querySelector(".dlss").textContent = dlss;
                    document.querySelector(".openglversion").textContent = openglversion;
                    document.querySelector(".directx").textContent = directx;
                    document.querySelector(".coreclock").textContent = coreclock;
                    document.querySelector(".coolingsystem").textContent = coolingsystem;
                }

                //Display RAM specifications

                if (isRamTransaction) {
                    document.querySelector(".memorytype").textContent = memorytype;
                    document.querySelector(".amount").textContent = amount;
                    document.querySelector(".memoryspeed").textContent = memoryspeed;
                    document.querySelector(".xmp").textContent = xmp;
                    document.querySelector(".storage").textContent = storage;
                    document.querySelector(".testedspeed").textContent = testedspeed;
                }

                if (prebuiltpcsection) {
                    document.querySelector(".cpu").textContent = cpu;
                    document.querySelector(".mobo").textContent = mobo;
                    document.querySelector(".graphicsunit").textContent = graphicsunit;
                    document.querySelector(".installedram").textContent = installedram;
                    document.querySelector(".ssd").textContent = ssd;
                    document.querySelector(".powerunit").textContent = powerunit;
                }
            }

            // Order form submission
            document.getElementById("checkout-form").addEventListener("submit", function (event) {
                event.preventDefault();

                // Generate a random order ID
                const orderId = `ORD-${Math.floor(Math.random() * 1000000)}`;

                // Get user input values
                const userName = document.getElementById("name").value;
                const userEmail = document.getElementById("email").value;
                const userAddress = document.getElementById("address").value;

                // Sanitize the product price to remove formatting (e.g., ₱42,000.00 -> 42000)
                const sanitizedPrice = parseFloat(productPrice.replace(/[₱,]/g, "")) || 0;

                // Build the URL for Tracking.html
                const trackingUrl = `Tracking.html?orderId=${orderId}&name=${encodeURIComponent(userName)}&email=${encodeURIComponent(userEmail)}&address=${encodeURIComponent(userAddress)}&products=${encodeURIComponent(JSON.stringify([{
                    name: productName,
                    img: productImage,
                    price: sanitizedPrice
                }]))}`;

                // Redirect to Tracking.html
                window.location.href = trackingUrl;
            });

            // Handle cancel button
            document.querySelector(".cancel-btn").addEventListener("click", function () {
                window.location.href = "shop.html"; // Redirect to shop.html
            });

            // Payment method selection
            const paymentSelect = document.getElementById("payment");
            const paymentDetails = document.getElementById("payment-details");
            const codFields = document.getElementById("cod-fields");

            // Function to update payment fields based on the selected payment method
            function updatePaymentFields() {
                paymentDetails.style.display = "block";
                codFields.style.display = "block";
            }

            // Listen for changes in the payment method dropdown
            paymentSelect.addEventListener("change", updatePaymentFields);

            // Trigger the update function on page load to handle the default selection
            updatePaymentFields();
        });
    </script>
</body>

</html>